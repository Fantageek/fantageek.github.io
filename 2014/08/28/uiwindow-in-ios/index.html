
 <!DOCTYPE HTML>
<html lang="English">
<head>
  <meta charset="UTF-8">
  
    <title>UIWindow in iOS | Fantageek</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Khoa Pham">
    

    
    <meta name="description" content="In this article, I ‘ll share what I know about UIWindow
keyWindowAn app can have many UIWindow. The key window is the one that is designated to receive keyboard and other non-touch related events. Onl">
<meta property="og:type" content="article">
<meta property="og:title" content="UIWindow in iOS">
<meta property="og:url" content="http://www.fantageek.com/2014/08/28/uiwindow-in-ios/index.html">
<meta property="og:site_name" content="Fantageek">
<meta property="og:description" content="In this article, I ‘ll share what I know about UIWindow
keyWindowAn app can have many UIWindow. The key window is the one that is designated to receive keyboard and other non-touch related events. Onl">
<meta property="og:image" content="http://www.fantageek.com/wp-content/uploads/2014/08/Screen-Shot-2014-08-31-at-8.32.39-PM-190x300.png">
<meta property="og:image" content="http://www.fantageek.com/wp-content/uploads/2014/08/Screen-Shot-2014-08-31-at-8.32.43-PM-300x215.png">
<meta property="og:updated_time" content="2016-04-14T19:30:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UIWindow in iOS">
<meta name="twitter:description" content="In this article, I ‘ll share what I know about UIWindow
keyWindowAn app can have many UIWindow. The key window is the one that is designated to receive keyboard and other non-touch related events. Onl">
<meta name="twitter:image" content="http://www.fantageek.com/wp-content/uploads/2014/08/Screen-Shot-2014-08-31-at-8.32.39-PM-190x300.png">
<meta name="twitter:creator" content="@onmyway133">

    
    <link rel="alternative" href="/atom.xml" title="Fantageek" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Fantageek" title="Fantageek"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Fantageek">Fantageek</a></h1>
				<h2 class="blog-motto">Simple apps that make sense</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:www.fantageek.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/08/28/uiwindow-in-ios/" title="UIWindow in iOS" itemprop="url">UIWindow in iOS</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2014-08-28T14:05:57.000Z" itemprop="datePublished"> Published 2014-08-28</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#keyWindow"><span class="toc-number">1.</span> <span class="toc-text">keyWindow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UIWindow-is-always-portrait"><span class="toc-number">2.</span> <span class="toc-text">UIWindow is always portrait</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Keyboard-is-a-window"><span class="toc-number">3.</span> <span class="toc-text">Keyboard is a window</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notification"><span class="toc-number">4.</span> <span class="toc-text">Notification</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Statusbar-is-a-window"><span class="toc-number">5.</span> <span class="toc-text">Statusbar is a window</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#statusBarFrame"><span class="toc-number">6.</span> <span class="toc-text">statusBarFrame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notification-1"><span class="toc-number">7.</span> <span class="toc-text">Notification</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-create-alert-view"><span class="toc-number">8.</span> <span class="toc-text">How to create alert view</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Don’t-use-rootViewController-approach"><span class="toc-number">9.</span> <span class="toc-text">Don’t use rootViewController approach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-add-view-to-existing-window"><span class="toc-number">10.</span> <span class="toc-text">How to add view to existing window</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-the-OS-creates-AlertView"><span class="toc-number">11.</span> <span class="toc-text">How the OS creates AlertView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Use-rootViewController-approach"><span class="toc-number">12.</span> <span class="toc-text">Use rootViewController approach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UIWindow-is-a-UIView"><span class="toc-number">13.</span> <span class="toc-text">UIWindow is a UIView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UIWindow-in-iOS-8"><span class="toc-number">14.</span> <span class="toc-text">UIWindow in iOS 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">15.</span> <span class="toc-text">Reference</span></a></li></ol>
		
		</div>
		
		<p>In this article, I ‘ll share what I know about UIWindow</p>
<h2 id="keyWindow"><a href="#keyWindow" class="headerlink" title="keyWindow"></a>keyWindow</h2><p>An app can have many UIWindow. The key window is the one that is designated to receive keyboard and other non-touch related events. Only one window at a time may be the key window.</p>
<p>You call makeKeyAndVisible or makeKeyWindow to make a UIWindow become the keyWindow. Note that UIWindow is hidden by default, so makeKeyAndVisible both makes a UIWindow become keyWindow and set its hidden property to NO</p>
<a id="more"></a>
<h2 id="UIWindow-is-always-portrait"><a href="#UIWindow-is-always-portrait" class="headerlink" title="UIWindow is always portrait"></a>UIWindow is always portrait</h2><p>Simply add the following code in application:didFinishLaunchingWithOptions:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIView</span> *view = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">100</span>)];</span><br><span class="line">    view.backgroundColor = [<span class="built_in">UIColor</span> greenColor];</span><br><span class="line">    view.autoresizingMask = <span class="built_in">UIViewAutoresizingFlexibleRightMargin</span> | <span class="built_in">UIViewAutoresizingFlexibleBottomMargin</span>;</span><br><span class="line">    [<span class="keyword">self</span>.window addSubview:view];</span><br><span class="line">    view.layer.zPosition = FLT_MAX;</span><br></pre></td></tr></table></figure>

then rotate the device/simulator, you will see that the green color view is always at position {0, 0},

<p><a href="http://www.fantageek.com/wp-content/uploads/2014/08/Screen-Shot-2014-08-31-at-8.32.39-PM.png"><img src="http://www.fantageek.com/wp-content/uploads/2014/08/Screen-Shot-2014-08-31-at-8.32.39-PM-190x300.png" alt="Screen Shot 2014-08-31 at 8.32.39 PM"></a><br><a href="http://www.fantageek.com/wp-content/uploads/2014/08/Screen-Shot-2014-08-31-at-8.32.43-PM.png"><img src="http://www.fantageek.com/wp-content/uploads/2014/08/Screen-Shot-2014-08-31-at-8.32.43-PM-300x215.png" alt="Screen Shot 2014-08-31 at 8.32.43 PM"></a></p>
<p>The UIWindow’s coordinate system is always in portrait orientation. It applies the rotation by setting its rootViewController’s view’s transform. So starting in iOS 4, application is advised to have rootViewController. See this wonderful answer from rob <a href="http://stackoverflow.com/a/8598515/1418457" target="_blank" rel="external">After rotation UIView coordinates are swapped but UIWindow’s are not?</a></p>
<h2 id="Keyboard-is-a-window"><a href="#Keyboard-is-a-window" class="headerlink" title="Keyboard is a window"></a>Keyboard is a window</h2><p>Note that UIApplication has an instance method “windows”</p>
<blockquote>
<p>The app’s visible and hidden windows. (read-only)<br>This property contains the UIWindow objects currently associated with the app. This list does not include windows created and managed by the system, such as the window used to display the status bar</p>
</blockquote>
<p>You can get the keyboard window by traversing this windows array. Code extracted from SVProgressHUD. Note that when the keyboard is shown, the windows array contains another window of type UITextEffectsWindow, that is the keyboard</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">CGFloat</span>)visibleKeyboardHeight &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UIWindow</span> *keyboardWindow = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">UIWindow</span> *testWindow <span class="keyword">in</span> [[<span class="built_in">UIApplication</span> sharedApplication] windows]) &#123;</span><br><span class="line">        <span class="keyword">if</span>(![[testWindow class] isEqual:[<span class="built_in">UIWindow</span> class]]) &#123;</span><br><span class="line">            keyboardWindow = testWindow;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (__<span class="keyword">strong</span> <span class="built_in">UIView</span> *possibleKeyboard <span class="keyword">in</span> [keyboardWindow subviews]) &#123;</span><br><span class="line">        <span class="keyword">if</span>([possibleKeyboard isKindOfClass:<span class="built_in">NSClassFromString</span>(<span class="string">@"UIPeripheralHostView"</span>)] || [possibleKeyboard isKindOfClass:<span class="built_in">NSClassFromString</span>(<span class="string">@"UIKeyboard"</span>)])</span><br><span class="line">            <span class="keyword">return</span> possibleKeyboard.bounds.size.height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As said previously, The UIWindow’s coordinate system is always in portrait orientation. Keyboard is a window, so its frame is always (0 0; 320 480) regardless of device orientation. When you rotate the device, the system applies a rotation transform to the keyboard window</p>
<p>User rotates the device to portrait</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">UITextEffectsWindow</span>: <span class="number">0x8e3ecc0</span>; frame = (<span class="number">0</span> <span class="number">0</span>; <span class="number">320</span> <span class="number">480</span>); opaque = <span class="literal">NO</span>; gestureRecognizers = &lt;<span class="built_in">NSArray</span>: <span class="number">0x8e3f240</span>&gt;; layer = &lt;<span class="built_in">UIWindowLayer</span>: <span class="number">0x8e3ee40</span>&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>User rotates the device to landscape<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">UITextEffectsWindow</span>: <span class="number">0x8e3ecc0</span>; frame = (<span class="number">0</span> <span class="number">0</span>; <span class="number">320</span> <span class="number">480</span>); transform = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">-80</span>, <span class="number">80</span>]; opaque = <span class="literal">NO</span>; gestureRecognizers = &lt;<span class="built_in">NSArray</span>: <span class="number">0x8e3f240</span>&gt;; layer = &lt;<span class="built_in">UIWindowLayer</span>: <span class="number">0x8e3ee40</span>&gt;&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="Notification"><a href="#Notification" class="headerlink" title="Notification"></a>Notification</h2><p>If you register for UIKeyboardWillShowNotification, you can confirm this</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserverForName:<span class="built_in">UIKeyboardWillShowNotification</span> object:<span class="literal">nil</span> queue:<span class="literal">nil</span> usingBlock:^(<span class="built_in">NSNotification</span> *note) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, note);</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure>
<p>User rotates the device to portrait<br>
UIKeyboardFrameEndUserInfoKey = "NSRect: {{0, 264}, {320, 216}}";
</p>
<p>User rotates the device to landscape<br>
UIKeyboardFrameEndUserInfoKey = "NSRect: {{0, 0}, {162, 480}}";
</p>
<p>So in your UIKeyboardWillShowNotification handler, you should convert it to your view coordinate system. Code extracted from <a href="http://stackoverflow.com/a/14351009/1418457" target="_blank" rel="external">Keyboard “WillShow” and “WillHide” vs. Rotation</a></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) keyboardWillShow:(<span class="built_in">NSNotification</span> *)aNotification</span><br><span class="line">&#123;</span><br><span class="line">     <span class="built_in">CGRect</span> keyboardFrame = [[[aNotification userInfo] objectForKey:<span class="built_in">UIKeyboardFrameBeginUserInfoKey</span>] <span class="built_in">CGRectValue</span>];</span><br><span class="line">    <span class="built_in">CGRect</span> convertedFrame = [<span class="keyword">self</span>.view convertRect:keyboardFrame fromView:<span class="keyword">self</span>.view.window];</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line">    <span class="comment">/* Do whatever you want now with the new frame.</span><br><span class="line">     * The width and height will actually be correct now</span><br><span class="line">     */</span></span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Statusbar-is-a-window"><a href="#Statusbar-is-a-window" class="headerlink" title="Statusbar is a window"></a>Statusbar is a window</h2><p>As said previously, the windows array does not contain the statusbar window. Statusbar window is of type UIStatusBarWindow, you can get it with the following code (extracted from FLEX)</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIWindow</span> *)statusWindow</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *statusBarString = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"_statusBarWindow"</span>];</span><br><span class="line">    <span class="keyword">return</span> [[<span class="built_in">UIApplication</span> sharedApplication] valueForKey:statusBarString];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Like the keyboard window, the status bar frame is unchanged. When you rotate the device, the system applies rotation transform to the status bar</p>
<p>User rotates the device to portrait<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">UIStatusBarWindow</span>: <span class="number">0x8f61e30</span>; frame = (<span class="number">0</span> <span class="number">0</span>; <span class="number">320</span> <span class="number">480</span>); gestureRecognizers = &lt;<span class="built_in">NSArray</span>: <span class="number">0x8f62e40</span>&gt;; layer = &lt;<span class="built_in">UIWindowLayer</span>: <span class="number">0x8f620d0</span>&gt;&gt;</span><br></pre></td></tr></table></figure></p>
<p>User rotates the device to landscape<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">UIStatusBarWindow</span>: <span class="number">0x8f61e30</span>; frame = (<span class="number">0</span> <span class="number">0</span>; <span class="number">320</span> <span class="number">480</span>); transform = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]; gestureRecognizers = &lt;<span class="built_in">NSArray</span>: <span class="number">0x8f62e40</span>&gt;; layer = &lt;<span class="built_in">UIWindowLayer</span>: <span class="number">0x8f620d0</span>&gt;&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="statusBarFrame"><a href="#statusBarFrame" class="headerlink" title="statusBarFrame"></a>statusBarFrame</h2><p>UIApplication has a property called statusBarFrame, which is always reported in portrait coordinate system.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CGRect</span> rect = [<span class="built_in">UIApplication</span> sharedApplication].statusBarFrame;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"statusBarFrame %@"</span>, <span class="built_in">NSStringFromCGRect</span>(rect));</span><br></pre></td></tr></table></figure>
<p>User rotates the device to portrait<br>
statusBarFrame {{0, 0}, {320, 20}}

User rotates the device to landscape
statusBarFrame {{300, 0}, {20, 480}}
</p>
<p>If you merely want to get the status height, regardless of orientation, you can just get the max</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> statusBarHeight = MIN([<span class="built_in">UIApplication</span> sharedApplication].statusBarFrame.size.height, [<span class="built_in">UIApplication</span> sharedApplication].statusBarFrame.size.width);</span><br></pre></td></tr></table></figure>
<h2 id="Notification-1"><a href="#Notification-1" class="headerlink" title="Notification"></a>Notification</h2><p>When the device is rotated, the system issues UIApplicationWillChangeStatusBarFrameNotification and UIApplicationDidChangeStatusBarFrameNotification.</p>
<p>Let’s now handle UIApplicationDidChangeStatusBarFrameNotification to see</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserverForName:<span class="built_in">UIApplicationWillChangeStatusBarFrameNotification</span> object:<span class="literal">nil</span> queue:<span class="literal">nil</span> usingBlock:^(<span class="built_in">NSNotification</span> *note) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, note);</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserverForName:<span class="built_in">UIApplicationDidChangeStatusBarFrameNotification</span> object:<span class="literal">nil</span> queue:<span class="literal">nil</span> usingBlock:^(<span class="built_in">NSNotification</span> *note) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, note);</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure>
<p>I don’t know why but the WillChange notification gives me the final result, while the DidChange notification give me the old result. By result, I mean the value of the statusBarFrame<br>I also see that no libraries use the DidChange notification</p>
<h2 id="How-to-create-alert-view"><a href="#How-to-create-alert-view" class="headerlink" title="How to create alert view"></a>How to create alert view</h2><p>To create an alertview, you can simply present an UIViewController (with smaller size). For advanced cases, you must understand the presentation context. And the way to use your alertview is a bit hard. What we always want is a simple call</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[alertView show];</span><br></pre></td></tr></table></figure>
<p>It ‘s not to say that some view can appears on top of your alert view, so they defeats your purpose as an alertview</p>
<p>The fancy way is to work with UIWindow. I see many libraries use one of these 2 approaches</p>
<h2 id="Don’t-use-rootViewController-approach"><a href="#Don’t-use-rootViewController-approach" class="headerlink" title="Don’t use rootViewController approach"></a>Don’t use rootViewController approach</h2><p>Some libraries like OLGhostAlertView, SVProgressHUD, WYPopoverController, MTStatusBarOverlay … don’t use rootViewController. They can create new UIWindow (MTStatusBarOverlay) or use existing UIWindow, they addSubview directly to the window, so they handle orientation by listen to UIApplicationDidChangeStatusBarOrientationNotification or UIApplicationWillChangeStatusBarFrameNotification</p>
<p>The handler is like this, extracted from SVProgressHUD. The idea is manually get the orientation and applies a rotation transform to their view</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)handleOrientationChange:(<span class="built_in">NSNotification</span> *)note</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIInterfaceOrientation</span> orientation = [[<span class="built_in">UIApplication</span> sharedApplication] statusBarOrientation];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGRect</span> orientationFrame = [<span class="built_in">UIScreen</span> mainScreen].bounds;</span><br><span class="line">    <span class="built_in">CGRect</span> statusBarFrame = [<span class="built_in">UIApplication</span> sharedApplication].statusBarFrame;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">UIInterfaceOrientationIsLandscape</span>(orientation)) &#123;</span><br><span class="line">        <span class="keyword">float</span> temp = orientationFrame.size.width;</span><br><span class="line">        orientationFrame.size.width = orientationFrame.size.height;</span><br><span class="line">        orientationFrame.size.height = temp;</span><br><span class="line"></span><br><span class="line">        temp = statusBarFrame.size.width;</span><br><span class="line">        statusBarFrame.size.width = statusBarFrame.size.height;</span><br><span class="line">        statusBarFrame.size.height = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (orientation) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">UIInterfaceOrientationPortraitUpsideDown</span>:</span><br><span class="line">            rotateAngle = M_PI;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">UIInterfaceOrientationLandscapeLeft</span>:</span><br><span class="line">            rotateAngle = -M_PI/<span class="number">2.0</span>f;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">UIInterfaceOrientationLandscapeRight</span>:</span><br><span class="line">            rotateAngle = M_PI/<span class="number">2.0</span>f;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>: <span class="comment">// as UIInterfaceOrientationPortrait</span></span><br><span class="line">            rotateAngle = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="How-to-add-view-to-existing-window"><a href="#How-to-add-view-to-existing-window" class="headerlink" title="How to add view to existing window"></a>How to add view to existing window</h2><p>Libraries have their own strategy to add view to existing window</p>
<p>SVProgressHUD tries to add to the front window<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">self</span>.overlayView.superview)&#123;</span><br><span class="line">        <span class="built_in">NSEnumerator</span> *frontToBackWindows = [[[<span class="built_in">UIApplication</span> sharedApplication]windows]reverseObjectEnumerator];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">UIWindow</span> *window <span class="keyword">in</span> frontToBackWindows)</span><br><span class="line">            <span class="keyword">if</span> (window.windowLevel == <span class="built_in">UIWindowLevelNormal</span>) &#123;</span><br><span class="line">                [window addSubview:<span class="keyword">self</span>.overlayView];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="How-the-OS-creates-AlertView"><a href="#How-the-OS-creates-AlertView" class="headerlink" title="How the OS creates AlertView"></a>How the OS creates AlertView</h2><p>Watch WWDC 2014 Session 228 A Look Inside Presentation Controllers, they said</p>
<blockquote>
<p>Behind the scenes, the framework creates a window on your app’s behalf, but this predates iOS 8 window rotation behavior, so this window is technically still in portrait.</p>
</blockquote>
<p>We then add the action sheet to that window and mimic the transform hierarchy of the presenting view to get into the right orientation.</p>
<h2 id="Use-rootViewController-approach"><a href="#Use-rootViewController-approach" class="headerlink" title="Use rootViewController approach"></a>Use rootViewController approach</h2><p>Some libraries, like FLEX, SIAlertView, … create new UIWindow and assign rootViewController to that window. This way orientation is reported to the rootViewController. They then simply add view to the rootViewController.view and handle orientation right in the view controller.</p>
<p>Code extracted from FLEXViewExplorerViewController<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSUInteger</span>)supportedInterfaceOrientations</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIViewController</span> *viewControllerToAsk = [<span class="keyword">self</span> viewControllerForStatusBarAndOrientationProperties];</span><br><span class="line">    <span class="built_in">NSUInteger</span> supportedOrientations = [FLEXUtility infoPlistSupportedInterfaceOrientationsMask];</span><br><span class="line">    <span class="keyword">if</span> (viewControllerToAsk &amp;&amp; viewControllerToAsk != <span class="keyword">self</span>) &#123;</span><br><span class="line">        supportedOrientations = [viewControllerToAsk supportedInterfaceOrientations];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The UIViewController docs state that this method must not return zero.</span></span><br><span class="line">    <span class="comment">// If we weren't able to get a valid value for the supported interface orientations, default to all supported.</span></span><br><span class="line">    <span class="keyword">if</span> (supportedOrientations == <span class="number">0</span>) &#123;</span><br><span class="line">        supportedOrientations = <span class="built_in">UIInterfaceOrientationMaskAll</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> supportedOrientations;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)shouldAutorotate</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIViewController</span> *viewControllerToAsk = [<span class="keyword">self</span> viewControllerForStatusBarAndOrientationProperties];</span><br><span class="line">    <span class="built_in">BOOL</span> shouldAutorotate = <span class="literal">YES</span>;</span><br><span class="line">    <span class="keyword">if</span> (viewControllerToAsk &amp;&amp; viewControllerToAsk != <span class="keyword">self</span>) &#123;</span><br><span class="line">        shouldAutorotate = [viewControllerToAsk shouldAutorotate];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> shouldAutorotate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)willRotateToInterfaceOrientation:(<span class="built_in">UIInterfaceOrientation</span>)toInterfaceOrientation duration:(<span class="built_in">NSTimeInterval</span>)duration</span><br><span class="line">&#123;</span><br><span class="line">    [...]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)didRotateFromInterfaceOrientation:(<span class="built_in">UIInterfaceOrientation</span>)fromInterfaceOrientation</span><br><span class="line">&#123;</span><br><span class="line">    [...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Since FLEX creates new Window, it must consults the app original Window for rotation capability. Note the infoPlistSupportedInterfaceOrientationsMask and viewControllerForStatusBarAndOrientationProperties, you can learn much from it</p>
<h2 id="UIWindow-is-a-UIView"><a href="#UIWindow-is-a-UIView" class="headerlink" title="UIWindow is a UIView"></a>UIWindow is a UIView</h2><p>Since UIWindow is a UIView subclass, you can do many things you already know with UIView. For example, FLEX override pointInside:withEvent: to intercept touch through its toolbar</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)pointInside:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">BOOL</span> pointInside = <span class="literal">NO</span>;</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.eventDelegate shouldHandleTouchAtPoint:point]) &#123;</span><br><span class="line">        pointInside = [<span class="keyword">super</span> pointInside:point withEvent:event];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pointInside;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="UIWindow-in-iOS-8"><a href="#UIWindow-in-iOS-8" class="headerlink" title="UIWindow in iOS 8"></a>UIWindow in iOS 8</h2><p>In iOS 8, Apple introduce Size Classes, and “Rotation is an animated bounds change”. And UIWindow is reported in device orientation</p>
<p>WWDC 2014 Session 216 Building Adaptive Apps with UIKit</p>
<blockquote>
<p>Trait Environments are a new protocol that are able to return their current Trait Collection, and these include Screens, Windows, View Controllers, and also Views.</p>
</blockquote>
<p>All of these are able to return their current Trait Collection to you to use to determine how your interface should be laid out.</p>
<p>See <a href="http://stackoverflow.com/questions/24150359/is-uiscreen-mainscreen-bounds-size-becoming-orientation-dependent-in-ios8/24153540#24153540" target="_blank" rel="external">Is [UIScreen mainScreen].bounds.size becoming orientation-dependent in iOS8?</a></p>
<p>UIScreen is now interface oriented:</p>
<ul>
<li>[UIScreen bounds] now interface-oriented</li>
</ul>
<ul>
<li>[UIScreen applicationFrame] now interface-oriented</li>
</ul>
<ul>
<li>Status bar frame notifications are interface-oriented</li>
</ul>
<ul>
<li>Keyboard frame notifications are interface-oriented</li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li><a href="http://b2cloud.com.au/tutorial/multiple-uiwindows/" target="_blank" rel="external">Multiple UIWindows</a></li>
</ol>
<ol>
<li><a href="http://stackoverflow.com/questions/19995526/to-create-a-new-uiwindow-over-the-main-window" target="_blank" rel="external">To create a new UIWindow over the main window</a></li>
</ol>
<ol>
<li><a href="http://stackoverflow.com/questions/8232398/advantages-problems-examples-of-adding-another-uiwindow-to-an-ios-app" target="_blank" rel="external">Advantages, problems, examples of adding another UIWindow to an iOS app?</a></li>
</ol>
<ol>
<li><a href="http://stackoverflow.com/questions/8233976/the-difference-between-a-uiwindow-and-a-uiview" target="_blank" rel="external">The difference between a UIWindow and a UIView</a></li>
</ol>
<ol>
<li><a href="http://shaune.com.au/using-multiple-uiwindows-in-ios-applications/" target="_blank" rel="external">Using multiple UIWindows in iOS applications</a></li>
</ol>
<ol>
<li><a href="https://developer.apple.com/library/ios/qa/qa1688/_index.html" target="_blank" rel="external">Technical Q&amp;A QA1688 Why won’t my UIViewController rotate with the device?</a></li>
</ol>
<ol>
<li><a href="http://stackoverflow.com/questions/8598315/after-rotation-uiview-coordinates-are-swapped-but-uiwindows-are-not" target="_blank" rel="external">After rotation UIView coordinates are swapped but UIWindow’s are not?</a></li>
</ol>
<ol>
<li><a href="https://developer.apple.com/videos/wwdc/2014/" target="_blank" rel="external">WWDC 2014 Session 214 View Controller Advancement in iOS 8</a></li>
</ol>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/ios/">ios</a><a href="/tags/level/">level</a><a href="/tags/alert/">alert</a><a href="/tags/uiwindow/">uiwindow</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://www.fantageek.com/2014/08/28/uiwindow-in-ios/" data-title="UIWindow in iOS | Fantageek" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2014/08/31/dsl-in-objective-c/" title="DSL in Objective C">
  <strong>上一篇：</strong><br/>
  <span>
  DSL in Objective C</span>
</a>
</div>


<div class="next">
<a href="/2014/08/24/some-good-ios-questions/"  title="Some good iOS questions">
 <strong>下一篇：</strong><br/> 
 <span>Some good iOS questions
</span>
</a>
</div>

</nav>

	

<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#keyWindow"><span class="toc-number">1.</span> <span class="toc-text">keyWindow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UIWindow-is-always-portrait"><span class="toc-number">2.</span> <span class="toc-text">UIWindow is always portrait</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Keyboard-is-a-window"><span class="toc-number">3.</span> <span class="toc-text">Keyboard is a window</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notification"><span class="toc-number">4.</span> <span class="toc-text">Notification</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Statusbar-is-a-window"><span class="toc-number">5.</span> <span class="toc-text">Statusbar is a window</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#statusBarFrame"><span class="toc-number">6.</span> <span class="toc-text">statusBarFrame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notification-1"><span class="toc-number">7.</span> <span class="toc-text">Notification</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-create-alert-view"><span class="toc-number">8.</span> <span class="toc-text">How to create alert view</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Don’t-use-rootViewController-approach"><span class="toc-number">9.</span> <span class="toc-text">Don’t use rootViewController approach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-add-view-to-existing-window"><span class="toc-number">10.</span> <span class="toc-text">How to add view to existing window</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-the-OS-creates-AlertView"><span class="toc-number">11.</span> <span class="toc-text">How the OS creates AlertView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Use-rootViewController-approach"><span class="toc-number">12.</span> <span class="toc-text">Use rootViewController approach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UIWindow-is-a-UIView"><span class="toc-number">13.</span> <span class="toc-text">UIWindow is a UIView</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UIWindow-in-iOS-8"><span class="toc-number">14.</span> <span class="toc-text">UIWindow in iOS 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">15.</span> <span class="toc-text">Reference</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github Card</p>
<div class="github-card" data-github="onmyway133" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/Android/" title="Android">Android<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/Java-Script/" title="Java Script">Java Script<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Life/" title="Life">Life<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Miscellaneous/" title="Miscellaneous">Miscellaneous<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Mobile-Labs/" title="Mobile Labs">Mobile Labs<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/Others/" title="Others">Others<sup>26</sup></a></li>
		  
		
		  
			<li><a href="/categories/Programming/" title="Programming">Programming<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/Others/Windows-8/" title="Windows 8">Windows 8<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Windows-8/" title="Windows 8">Windows 8<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Windows-Phone/" title="Windows Phone">Windows Phone<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/Windows-8/Windows-Phone/" title="Windows Phone">Windows Phone<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/" title="iOS">iOS<sup>84</sup></a></li>
		  
		
		  
			<li><a href="/categories/programming/" title="programming">programming<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/ios/" title="ios">ios<sup>20</sup></a></li>
			
		
			
				<li><a href="/tags/wp7/" title="wp7">wp7<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/mac-osx/" title="mac osx">mac osx<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/tutorial/" title="tutorial">tutorial<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/wp8/" title="wp8">wp8<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/android/" title="android">android<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C">C<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/windows-8/" title="windows 8">windows 8<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/convert/" title="convert">convert<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/build/" title="build">build<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/disable/" title="disable">disable<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/visual-studio/" title="visual studio">visual studio<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/svn/" title="svn">svn<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/programming/" title="programming">programming<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/openssl/" title="openssl">openssl<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/xcode/" title="xcode">xcode<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/file/" title="file">file<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/facebook/" title="facebook">facebook<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/voip/" title="voip">voip<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/project/" title="project">project<sup>3</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> A dream is not a dream anymore when you don&#39;t have time for it <br/>
			What you don&#39;t know if what you haven&#39;t learned</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/onmyway133" target="_blank" class="icon-github" title="github"></a>
		
		
		<a href="http://stackoverflow.com/users/1418457/onmyway133" target="_blank" class="icon-stack-overflow" title="stackoverflow"></a>
		
		
		<a href="https://twitter.com/onmyway133" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		
		
		
		
		
		<a href="mailto:onmyway133@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="Khoa Pham">Khoa Pham</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>




<script type="text/javascript">

var disqus_shortname = 'fantageek';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-40119591-1', 'fantageek.com');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
