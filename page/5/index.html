
 <!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
    <title>Fantageek</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Khoa Pham">
    

    
    <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Fantageek">
<meta property="og:url" content="http://www.fantageek.com/page/5/index.html">
<meta property="og:site_name" content="Fantageek">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fantageek">
<meta name="twitter:description">
<meta name="twitter:creator" content="@onmyway133">

    
    <link rel="alternative" href="/atom.xml" title="Fantageek" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Fantageek" title="Fantageek"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Fantageek">Fantageek</a></h1>
				<h2 class="blog-motto">Simple apps that make sense</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:www.fantageek.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/07/14/simple-caching/" title="Simple caching" itemprop="url">Simple caching</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-07-14T11:10:27.000Z" itemprop="datePublished"> Published 2015-07-14</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="Memory-and-disk"><a href="#Memory-and-disk" class="headerlink" title="Memory and disk"></a>Memory and disk</h2><p>This simple cache uses both memory and disk cache</p>
<ul>
<li>Retrieval: Ask memory first. If not, ask disk, then set back to memory cache</li>
<li>Save: Save to both memory and disk.</li>
</ul>
<p>I used to use <a href="https://github.com/tumblr/TMCache" target="_blank" rel="external">TMCache</a>, but then I found <a href="https://realm.io/docs/objc/latest/" target="_blank" rel="external">Realm</a> to be much better.</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>Take a look at my gist <a href="https://gist.github.com/onmyway133/50d7139314bc196bf2e2" target="_blank" rel="external">SimpleCache</a></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://github.com/Haneke/Haneke" target="_blank" rel="external">Haneke</a></li>
</ul>
<ul>
<li><a href="https://github.com/path/FastImageCache" target="_blank" rel="external">FastImageCache</a></li>
</ul>
<ul>
<li><a href="https://github.com/rs/SDWebImage" target="_blank" rel="external">SDWebImage</a></li>
</ul>
<ul>
<li><a href="https://blogs.dropbox.com/tech/2012/10/caching-in-theory-and-practice/" target="_blank" rel="external">Caching in theory and practice</a></li>
</ul>
<ul>
<li><a href="https://bpoplauschi.wordpress.com/2014/03/21/ios-image-caching-sdwebimage-vs-fastimage/" target="_blank" rel="external">iOS image caching. Libraries benchmark (SDWebImage vs FastImageCache)</a></li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/07/14/simple-caching/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/07/11/debugging-auto-layout/" title="Debugging Auto Layout" itemprop="url">Debugging Auto Layout</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-07-11T12:05:50.000Z" itemprop="datePublished"> Published 2015-07-11</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="hasAmbiguousLayout"><a href="#hasAmbiguousLayout" class="headerlink" title="hasAmbiguousLayout"></a>hasAmbiguousLayout</h3><blockquote><br>  Returns whether the constraints impacting the layout of the view incompletely specify the location of the view.<br></blockquote>





<h3 id="exerciseAmbiguityInLayout"><a href="#exerciseAmbiguityInLayout" class="headerlink" title="exerciseAmbiguityInLayout"></a>exerciseAmbiguityInLayout</h3><blockquote><br>  This method randomly changes the frame of a view with an ambiguous layout between its different valid values, causing the view to move in the interface. This makes it easy to visually identify what the valid frames are and may enable the developer to discern what constraints need to be added to the layout to fully specify a location for the view.<br></blockquote>





<h3 id="autolayoutTrace"><a href="#autolayoutTrace" class="headerlink" title="_autolayoutTrace"></a>_autolayoutTrace</h3><blockquote><br>  This returns a string describing the whole view tree which tells you when a view has an ambiguous layout.<br></blockquote>





<h3 id="NSLayoutConstraint-identifier"><a href="#NSLayoutConstraint-identifier" class="headerlink" title="NSLayoutConstraint identifier"></a>NSLayoutConstraint identifier</h3><blockquote><br>  The name that identifies the constraint.<br></blockquote>





<h3 id="UIViewAlertForUnsatisfiableConstraints"><a href="#UIViewAlertForUnsatisfiableConstraints" class="headerlink" title="UIViewAlertForUnsatisfiableConstraints"></a>UIViewAlertForUnsatisfiableConstraints</h3><p><a href="http://nshint.io/blog/2015/08/17/autolayout-breakpoints/" target="_blank" rel="external">Autolayout Breakpoints</a></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="http://www.objc.io/issues/3-views/advanced-auto-layout-toolbox/" target="_blank" rel="external">Advanced Auto Layout Toolbox</a></li>
</ul>
<ul>
<li><a href="http://asciiwwdc.com/2015/sessions/219" target="_blank" rel="external">Mysteries of Auto Layout, Part 2</a></li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/07/11/debugging-auto-layout/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/07/11/understanding-layout-guide/" title="Understanding Layout Guide" itemprop="url">Understanding Layout Guide</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-07-11T12:00:12.000Z" itemprop="datePublished"> Published 2015-07-11</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="iOS-8"><a href="#iOS-8" class="headerlink" title="iOS 8"></a>iOS 8</h2><p><code>topLayoutGuide</code> and <code>bottomLayoutGuide</code></p>
<ul>
<li>is a property on UIViewController</li>
<li>inherits from UIView</li>
<li>conforms to UILayoutSupport protocol</li>
</ul>
<h3 id="UILayoutSupport"><a href="#UILayoutSupport" class="headerlink" title="UILayoutSupport"></a><a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UILayoutSupport_Protocol/" target="_blank" rel="external">UILayoutSupport</a></h3><blockquote><br>  In iOS 7 and later, a view controller’s view occupies the full height of the screen when there are no opaque UIKit bars (such as opaque navigation or tab bars). To keep your content within the area of a view that is not overlaid by translucent or transparent UIKit bars, employ the topLayoutGuide and bottomLayoutGuide properties in the UIViewController class and take advantage of Auto Layout. Query these properties within your implementation of the UIViewController method viewDidLayoutSubviews.<br><br>  The guides work as follows:<br>  - The top layout guide indicates the distance, in points, between the top of a view controller’s view and the bottom of the bottommost bar that overlays the view<br>  - The bottom layout guide indicates the distance, in points, between the bottom of a view controller’s view and the top the bar (such as a tab bar) that overlays the view.<br></blockquote>





<h3 id="topLayoutGuide"><a href="#topLayoutGuide" class="headerlink" title="topLayoutGuide"></a><a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/#//apple_ref/occ/instp/UIViewController/topLayoutGuide" target="_blank" rel="external">topLayoutGuide</a></h3><blockquote><br>  The topLayoutGuide property comes into play when a view controller is frontmost onscreen. It indicates the highest vertical extent for content that you don’t want to appear behind a translucent or transparent UIKit bar (such as a status or navigation bar). This property implements the UILayoutSupport protocol and you can employ it as a constraint item when using the NSLayoutConstraint class.<br><br>  The value of this property is, specifically, the value of the length property of the object returned when you query this property. This value is constrained by either the view controller or by its enclosing container view controller (such as a navigation or tab bar controller), as follows:<br><br>  A view controller not within a container view controller constrains this property to indicate the bottom of the status bar, if visible, or else to indicate the top edge of the view controller’s view.<br><br>  A view controller within a container view controller does not set this property’s value. Instead, the container view controller constrains the value to indicate:<br>  - The bottom of the navigation bar, if a navigation bar is visible<br>  - The bottom of the status bar, if only a status bar is visible<br>  - The top edge of the view controller’s view, if neither a status bar nor navigation bar is visible<br><br>  If a container navigation controller’s navigation bar is visible and opaque, the navigation controller lays out the frontmost view controller’s view so its top edge abuts the bottom of the navigation bar. In this case, the value of this property is 0.<br></blockquote>





<h3 id="bottomLayoutGuide"><a href="#bottomLayoutGuide" class="headerlink" title="bottomLayoutGuide"></a><a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/#//apple_ref/occ/instp/UIViewController/topLayoutGuide" target="_blank" rel="external">bottomLayoutGuide</a></h3><h2 id="iOS-9"><a href="#iOS-9" class="headerlink" title="iOS 9"></a>iOS 9</h2><h3 id="UILayoutGuide"><a href="#UILayoutGuide" class="headerlink" title="UILayoutGuide"></a><a href="https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UILayoutGuide_Class_Reference/index.html#//apple_ref/occ/cl/UILayoutGuide" target="_blank" rel="external">UILayoutGuide</a></h3><p><code>topLayoutGuide</code> and <code>bottomLayoutGuide</code> </p>
<ul>
<li>inherits from UILayoutGuide</li>
</ul>
<blockquote><br>  They do not participate in the view hierarchy. Instead, they simply define a rectangular region in their owning view’s coordinate system that can interact with Auto Layout.<br><br>  Layout guides can also act as a black box, containing a number of other views and controls. This lets you encapsulate part of your view, breaking your layout into modular chunks.<br></blockquote>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/07/11/understanding-layout-guide/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/07/10/understanding-monad/" title="Understanding Monad" itemprop="url">Understanding Monad</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-07-10T05:39:10.000Z" itemprop="datePublished"> Published 2015-07-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>I love functional programming. As always, a search will lead you into <a href="http://stackoverflow.com/questions/1028250/what-is-functional-reactive-programming" target="_blank" rel="external">What is (functional) reactive programming?</a>, which will strike you back. If you dont fully understand that, no problem. People can answer that because they have played with functional paradigm for years, and they can <code>feel</code> it.</p>
<p>So why not just pick a functional language and play with it, then after that come back to that question later, you will be amazed by how much you can understand the answers there.</p>
<p>To me, a function language must ensure</p>
<ul>
<li>First class function: which treat function as normal value that can be passed to another function and as a return value</li>
<li>No side effect. Remember <code>y = f(x)</code> which just receives input <code>x</code> and return output <code>y</code>. No contact with the outside world. Search for <code>proceduce vs function</code> and you will know why</li>
</ul>
<h2 id="It-is-not-hard"><a href="#It-is-not-hard" class="headerlink" title="It is not hard"></a>It is not hard</h2><p>To me, it is <code>not hard</code>, it is just <code>challenging</code> and <code>fun</code></p>
<p>Yeah, functor, applicative functor and monad are fun</p>
<h2 id="Learning"><a href="#Learning" class="headerlink" title="Learning"></a>Learning</h2><p>My favorite language for learning functional paradigm is Javascript, Swift, Haskell and Elixir. Why they may not fully support functional attributes or encourage true functional behaviour, it is OK with me to learn the concepts.</p>
<p>I must admit that knowing several programming languages benefits you a long way. While there are many resources to learn functional programming and particularly, monad. I find these very useful. Learn in this order</p>
<ul>
<li><a href="https://github.com/MostlyAdequate/mostly-adequate-guide" target="_blank" rel="external">mostly-adequate-guide</a> This is by far the great book ever. It teaches me how to understand map, apply, join, chain easily. Javascript is very easy to read, so read this book first</li>
<li><a href="http://learnyouahaskell.com/chapters" target="_blank" rel="external">Learn You a Haskell for Great Good!
</a> Yeah, people can’t just ignore Haskell when they talk about functional programming. This book has very nice examples</li>
<li><a href="https://www.objc.io/books/fpinswift/" target="_blank" rel="external">Functional Programming in Swift</a> I like Swift and I really like how functional programming work in Swift</li>
<li><a href="http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html" target="_blank" rel="external">Functors, Applicatives, And Monads In Pictures</a> Through these illustrated pictures, we ‘ll understand better</li>
</ul>
<p>Visit <a href="https://github.com/onmyway133/SwiftyMonad" target="_blank" rel="external">SwiftyMonad</a> for my experiment in Swift</p>
<h3 id="Computational-Context"><a href="#Computational-Context" class="headerlink" title="Computational Context"></a>Computational Context</h3><h3 id="Map-with-Functor"><a href="#Map-with-Functor" class="headerlink" title="Map with Functor"></a>Map with Functor</h3><h3 id="Apply-with-Applicative-Functor"><a href="#Apply-with-Applicative-Functor" class="headerlink" title="Apply with Applicative Functor"></a>Apply with Applicative Functor</h3><h3 id="Bind-with-Monad"><a href="#Bind-with-Monad" class="headerlink" title="Bind with Monad"></a>Bind with Monad</h3><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="http://www.javiersoto.me/post/106875422394" target="_blank" rel="external">Functor and Monad in Swift</a></li>
<li><a href="http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html" target="_blank" rel="external">Functors, Applicatives, And Monads In Pictures</a></li>
<li><a href="https://realm.io/news/swift-summit-javier-soto-futures/" target="_blank" rel="external">Back to the Futures</a></li>
<li><a href="https://realm.io/news/swift-summit-al-skipp-monads/" target="_blank" rel="external">The Monad Among Us</a></li>
<li><a href="https://realm.io/news/compelling-code/" target="_blank" rel="external">Compelling Code</a></li>
<li><a href="https://www.youtube.com/watch?v=AcDaWe3S75c&amp;list=PLdr22uU_wISpW6XI1J0S7Lp-X8Km-HaQW&amp;index=15" target="_blank" rel="external">Functional Reactive Programming without Black Magic</a></li>
<li><a href="https://www.youtube.com/watch?v=vg7cOF30Svo&amp;index=4&amp;list=PLdr22uU_wISpW6XI1J0S7Lp-X8Km-HaQW" target="_blank" rel="external">Monads are not Monsters</a></li>
<li><a href="http://fsharpforfunandprofit.com/posts/recipe-part2/" target="_blank" rel="external">Railway oriented programming</a></li>
<li><a href="http://blog.sigfpe.com/2006/08/you-could-have-invented-monads-and.html" target="_blank" rel="external">You Could Have Invented Monads! (And Maybe You Already Have.)</a></li>
<li><a href="http://drboolean.gitbooks.io/mostly-adequate-guide/content/ch9.html" target="_blank" rel="external">mostly-adequate-guide</a></li>
<li><a href="https://www.youtube.com/watch?v=rJosPrqBqrA" target="_blank" rel="external">Functioning as a Functionalist</a></li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/07/10/understanding-monad/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/07/08/understanding-libextobjc/" title="Understanding libextobjc" itemprop="url">Understanding libextobjc</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T15:22:35.000Z" itemprop="datePublished"> Published 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="https://github.com/jspahrsummers/libextobjc" target="_blank" rel="external">libextobjc</a></p>
<blockquote><br>  A Cocoa library to extend the Objective-C programming language.<br></blockquote>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/07/08/understanding-libextobjc/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/07/04/ios-configuration/" title="iOS configuration" itemprop="url">iOS configuration</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-07-04T02:19:32.000Z" itemprop="datePublished"> Published 2015-07-04</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>This is about creating multiple targets from a project.</p>
<h3 id="Source-file"><a href="#Source-file" class="headerlink" title="Source file"></a>Source file</h3><p>Source files (.m, .plist, …) must be checked into appropriate target</p>
<h3 id="Info-plist"><a href="#Info-plist" class="headerlink" title="Info.plist"></a>Info.plist</h3><p>Each target should have its own Info.plist. Info.plist should not be checked into the target. Otherwise, you will get a warning</p>
<blockquote><br>  The Copy Bundle Resources build phase contains this target’s Info.plist file<br></blockquote>



<p>Instead, it must be specified in the target ‘s <code>Build Setting -&gt; Packaging -&gt; Info.plist file</code>. It can be absolute or relative to the project file</p>
<h3 id="Entitlement"><a href="#Entitlement" class="headerlink" title="Entitlement"></a>Entitlement</h3><p>Entitlement should not be checked into the target</p>
<p>Instead, it must be specified in the target ‘s <code>Build Setting -&gt; Code Signing -&gt; Code Signing Entitlement</code>. Ut can be absolute or relative to the project file</p>
<h3 id="Asset-Catalog"><a href="#Asset-Catalog" class="headerlink" title="Asset Catalog"></a>Asset Catalog</h3><p>Asset Catalog must be checked into the appropriate target. The fix for multiple target with multiple Asset Catalog together with Cocoapods is <a href="https://github.com/2359media/ios-dev-discussions/issues/7" target="_blank" rel="external">Multiple targets and Asset Catalog with Cocoapods</a></p>
<h3 id="Read-Build-Setting-Reference"><a href="#Read-Build-Setting-Reference" class="headerlink" title="Read Build Setting Reference"></a>Read Build Setting Reference</h3><p><a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Reference/XcodeBuildSettingRef/1-Build_Setting_Reference/build_setting_ref.html" target="_blank" rel="external">Build Setting Reference</a> has some predefined macros that can be useful.</p>
<h3 id="Preprocessor-Macro"><a href="#Preprocessor-Macro" class="headerlink" title="Preprocessor Macro"></a>Preprocessor Macro</h3><p>Under target <code>Build Setting -&gt; Apple LLVM Preprocessing -&gt; Preprocessor Macros</code>, we can define our own macro, which can be useful in code.</p>
<p>For example, in Distro A target, I can set macro DISTRO_A to both Debug and Release Configuration.</p>
<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><p>Multiple targets can have different configuration (server path, Facebook ID, …). This can be achieved by several ways</p>
<h4 id="ifdef"><a href="#ifdef" class="headerlink" title="ifdef"></a>ifdef</h4><p>[code lang=text]</p>
<p>#ifdef DISTRO_A<br>NSString *serverPath = @”<a href="http://distro-a.com" target="_blank" rel="external">http://distro-a.com</a>“;</p>
<p>#else<br>NSString *serverPath = @”<a href="http://distro-b.com" target="_blank" rel="external">http://distro-b.com</a>“;</p>
<p>#endif<br>[/code]</p>
<h4 id="1-config-h-file-and-multiple-config-m-file-for-each-target"><a href="#1-config-h-file-and-multiple-config-m-file-for-each-target" class="headerlink" title="1 config.h file and multiple config.m file for each target"></a>1 config.h file and multiple config.m file for each target</h4><p><code>Config.h</code></p>
<p>[code lang=text]<br>extern NSString *serverPath;<br>[/code]</p>
<p><code>Config.m</code> (Distro A target)</p>
<p>[code lang=text]<br>NSString *serverPath = @”<a href="http://distro-a.com" target="_blank" rel="external">http://distro-a.com</a>“;<br>[/code]</p>
<p><code>Config.m</code> (Distro B target)</p>
<p>[code lang=text]<br>NSString *serverPath = @”<a href="http://distro-b.com" target="_blank" rel="external">http://distro-b.com</a>“;<br>[/code]</p>
<h4 id="Protocol-and-Abstract-Factory"><a href="#Protocol-and-Abstract-Factory" class="headerlink" title="Protocol and Abstract Factory"></a>Protocol and Abstract Factory</h4><p>We can define a protocol<br><code>Config.h</code><br>[code language=”objc”]<br>@protocol Config <nsobject></nsobject></p>
<ul>
<li>(NSString *)serverPath;</li>
</ul>
<p>@end<br>[/code]</p>
<p><code>DistroAConfig.h</code><br>[code language=”objc”]<br>@interface DistroAConfig : NSObject <config></config></p>
<p>@end<br>[/code]</p>
<p><code>DistroAConfig.m</code><br>[code language=”objc”]<br>@implementation DistroAConfig</p>
<ul>
<li>(NSString *)serverPath {<br>  return @”<a href="http://distro-a.com" target="_blank" rel="external">http://distro-a.com</a>“;<br>}</li>
</ul>
<p>@end<br>[/code]</p>
<h3 id="Theme"><a href="#Theme" class="headerlink" title="Theme"></a>Theme</h3><p>Each target can have different themes (different color, font, text size, spacing, …). We can use protocol together with Abstract Factory pattern. Each target has a ThemeFactory that can produces HomeTheme, SettingTheme, AboutTheme, FavoriteTheme, … This way you only need to use <code>ifdef</code> once</p>
<p><code>Theme.h</code><br>[code language=”objc”]<br>id<themefactory> themeFactory();<br>[/code]</themefactory></p>
<p><code>Theme.m</code><br>[code language=”objc”]<br>id<themefactory> themeFactory() {</themefactory></p>
<p>#ifdef DISTRO_A<br>    return [DistroAHomeThemeFactory new];</p>
<p>#else<br>    return [DistroBThemeFactory new];</p>
<p>#endif<br>}<br>[/code]</p>
<p><code>ThemeFactory.h</code><br>[code language=”objc”]<br>@protocol ThemeFactory <nsobject></nsobject></p>
<ul>
<li>(id<hometheme>)home;</hometheme></li>
</ul>
<p>@end<br>[/code]</p>
<p><code>HomeTheme.h</code><br>[code language=”objc”]<br>@protocol HomeTheme <nsobject></nsobject></p>
<ul>
<li>(UIColor *)titleColor;</li>
<li>(UIFont *)titleFont;</li>
</ul>
<p>@end<br>[/code]</p>
<p><code>DistroAThemeFactory.h</code><br>[code language=”objc”]<br>@interface DistroAThemeFactory : NSObject <themefactory><br>@end<br>[/code]</themefactory></p>
<p><code>DistroAThemeFactory.m</code><br>[code language=”objc”]<br>@implementation DistroAThemeFactory</p>
<ul>
<li>(id<hometheme>)home {<br>  return [DistroAHomeTheme new];<br>}</hometheme></li>
</ul>
<p>@end<br>[/code]</p>
<p><code>DistroAHomeTheme.h</code><br>[code language=”objc”]<br>@interface DistroAHomeTheme : NSObject <hometheme></hometheme></p>
<p>@end<br>[/code]</p>
<p><code>DistroAHomeTheme.m</code><br>[code language=”objc”]<br>@implementation DistroAHomeTheme</p>
<ul>
<li><p>(UIColor *)titleColor {<br>  return [UIColor redColor];<br>}</p>
</li>
<li><p>(UIFont *)titleFont {<br>  return [UIFont boldSystemFontOfSize:15];<br>}</p>
</li>
</ul>
<p>@end<br>[/code]</p>
<p><code>HomeViewController.m</code><br>[code language=”objc”]</p>
<p>#import “Theme.h”</p>
<p>self.label.textColor = themeFactory().home.titleColor;<br>[/code]</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="http://samwize.com/2014/05/22/create-multiple-targets-slash-apps-for-1-xcode-project/" target="_blank" rel="external">Create Multiple Targets/Apps for 1 Xcode Project</a></li>
</ul>
<ul>
<li><a href="http://lowlevelbits.org/yaml-based-configuration-for-objc-projects/" target="_blank" rel="external">YAML-based Configuration for ObjC Projects</a></li>
</ul>
<ul>
<li><a href="http://ilya.puchka.me/info-plist-preprocessing/" target="_blank" rel="external">Info.plist preprocessing</a></li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/07/04/ios-configuration/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/06/28/understanding-pstalertcontroller-weaksheetstorage/" title="Understanding PSTAlertController - weakSheetStorage" itemprop="url">Understanding PSTAlertController - weakSheetStorage</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-06-28T13:43:50.000Z" itemprop="datePublished"> Published 2015-06-28</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>For those who don’t use <a href="https://github.com/steipete/PSTAlertController" target="_blank" rel="external">PSTAlertController</a></p>
<blockquote><br>  API similar to UIAlertController, backwards compatible to iOS 7. Will use the new shiny API when you run iOS 8.<br></blockquote>



<p>The thing I find interesting about it is its dance for <code>weakSheetStorage</code> and <code>strongSheetStorage</code><br>Read <a href="https://github.com/steipete/PSTAlertController/issues/3" target="_blank" rel="external">Understand strongSheetStorage vs weakSheetStorage</a></p>
<blockquote><br>  It’s for exact object lifecycle management. The controller isn’t retained but needs to stick around, and once show is called we bind the lifetime to the views presented, so everything is cleaned up at the correct time without worrying about manually retaining things.<br></blockquote>





<h2 id="Init"><a href="#Init" class="headerlink" title="Init"></a>Init</h2><p>When PSTAlertController is initialized, it hold a strong reference to UIAlertView and UIActionSheet<br>[code language=”objc”]<br>if (preferredStyle == PSTAlertControllerStyleActionSheet) {<br>                _strongSheetStorage = [[UIActionSheet alloc] initWithTitle:title delegate:self cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:nil];<br>            } else {<br>                _strongSheetStorage = [[UIAlertView alloc] initWithTitle:title message:message delegate:self cancelButtonTitle:nil otherButtonTitles:nil];<br>            }<br>[/code]</p>
<h2 id="Show"><a href="#Show" class="headerlink" title="Show"></a>Show</h2><p>PSTAlertController may not be kept by any object, but the system keeps UIAlertView and UIActionSheet, so when UIAlertView and UIActionSheet is shown, we attach PSTAlertController to these<br>[code language=”objc”]</p>
<ul>
<li><p>(void)moveSheetToWeakStorage {<br>  NSParameterAssert(self.strongSheetStorage);</p>
<p>  objc_setAssociatedObject(self.strongSheetStorage, _cmd, self, OBJC_ASSOCIATION_RETAIN_NONATOMIC); // bind lifetime<br>  self.weakSheetStorage = self.strongSheetStorage;<br>  self.strongSheetStorage = nil;<br>}<br>[/code]</p>
</li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/06/28/understanding-pstalertcontroller-weaksheetstorage/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/06/28/understanding-flex-orientation/" title="Understanding FLEX - Orientation" itemprop="url">Understanding FLEX - Orientation</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-06-28T13:28:44.000Z" itemprop="datePublished"> Published 2015-06-28</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>FLEX ‘s bar always follow the orientation of your app. To do that, FLEX custom UIWindow ‘s rootViewController must ask your app for orientation and status bar style</p>
<h3 id="FLEXExplorerViewController-m"><a href="#FLEXExplorerViewController-m" class="headerlink" title="FLEXExplorerViewController.m"></a>FLEXExplorerViewController.m</h3><p>This is the core method, it finds the correct viewController to ask<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Try to get the preferred status bar properties from the app's root view controller (not us).</span></span><br><span class="line"><span class="comment">// In general, our window shouldn't be the key window when this view controller is asked about the status bar.</span></span><br><span class="line"><span class="comment">// However, we guard against infinite recursion and provide a reasonable default for status bar behavior in case our window is the keyWindow.</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIViewController</span> *)viewControllerForStatusBarAndOrientationProperties</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIViewController</span> *viewControllerToAsk = [[[<span class="built_in">UIApplication</span> sharedApplication] keyWindow] rootViewController];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// On iPhone, modal view controllers get asked</span></span><br><span class="line">    <span class="keyword">if</span> ([[<span class="built_in">UIDevice</span> currentDevice] userInterfaceIdiom] == <span class="built_in">UIUserInterfaceIdiomPhone</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (viewControllerToAsk.presentedViewController) &#123;</span><br><span class="line">            viewControllerToAsk = viewControllerToAsk.presentedViewController;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> viewControllerToAsk;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>For orientation, it simply asks the found viewController</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSUInteger</span>)supportedInterfaceOrientations</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIViewController</span> *viewControllerToAsk = [<span class="keyword">self</span> viewControllerForStatusBarAndOrientationProperties];</span><br><span class="line">    <span class="built_in">NSUInteger</span> supportedOrientations = [FLEXUtility infoPlistSupportedInterfaceOrientationsMask];</span><br><span class="line">    <span class="keyword">if</span> (viewControllerToAsk &amp;&amp; viewControllerToAsk != <span class="keyword">self</span>) &#123;</span><br><span class="line">        supportedOrientations = [viewControllerToAsk supportedInterfaceOrientations];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The UIViewController docs state that this method must not return zero.</span></span><br><span class="line">    <span class="comment">// If we weren't able to get a valid value for the supported interface orientations, default to all supported.</span></span><br><span class="line">    <span class="keyword">if</span> (supportedOrientations == <span class="number">0</span>) &#123;</span><br><span class="line">        supportedOrientations = <span class="built_in">UIInterfaceOrientationMaskAll</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> supportedOrientations;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://github.com/flipboard/flex" target="_blank" rel="external">FLEX</a></li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/06/28/understanding-flex-orientation/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/06/28/understanding-flex-hit-testing/" title="Understanding FLEX - Hit testing" itemprop="url">Understanding FLEX - Hit testing</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-06-28T13:25:04.000Z" itemprop="datePublished"> Published 2015-06-28</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>We can’t touch through FLEX ‘s bar to its underneath content. It’s a good thing to learn</p>
<h3 id="FLEXWindow-m"><a href="#FLEXWindow-m" class="headerlink" title="FLEXWindow.m"></a>FLEXWindow.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)pointInside:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">BOOL</span> pointInside = <span class="literal">NO</span>;</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.eventDelegate shouldHandleTouchAtPoint:point]) &#123;</span><br><span class="line">        pointInside = [<span class="keyword">super</span> pointInside:point withEvent:event];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pointInside;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="FLEXManager-m"><a href="#FLEXManager-m" class="headerlink" title="FLEXManager.m"></a>FLEXManager.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)shouldHandleTouchAtPoint:(<span class="built_in">CGPoint</span>)pointInWindow</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Ask the explorer view controller</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span>.explorerViewController shouldReceiveTouchAtWindowPoint:pointInWindow];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="FLEXExplorerViewController-m"><a href="#FLEXExplorerViewController-m" class="headerlink" title="FLEXExplorerViewController.m"></a>FLEXExplorerViewController.m</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)shouldReceiveTouchAtWindowPoint:(<span class="built_in">CGPoint</span>)pointInWindowCoordinates</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">BOOL</span> shouldReceiveTouch = <span class="literal">NO</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGPoint</span> pointInLocalCoordinates = [<span class="keyword">self</span>.view convertPoint:pointInWindowCoordinates fromView:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Always if it's on the toolbar</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectContainsPoint</span>(<span class="keyword">self</span>.explorerToolbar.frame, pointInLocalCoordinates)) &#123;</span><br><span class="line">        shouldReceiveTouch = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Always if we're in selection mode</span></span><br><span class="line">    <span class="keyword">if</span> (!shouldReceiveTouch &amp;&amp; <span class="keyword">self</span>.currentMode == FLEXExplorerModeSelect) &#123;</span><br><span class="line">        shouldReceiveTouch = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Always in move mode too</span></span><br><span class="line">    <span class="keyword">if</span> (!shouldReceiveTouch &amp;&amp; <span class="keyword">self</span>.currentMode == FLEXExplorerModeMove) &#123;</span><br><span class="line">        shouldReceiveTouch = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Always if we have a modal presented</span></span><br><span class="line">    <span class="keyword">if</span> (!shouldReceiveTouch &amp;&amp; <span class="keyword">self</span>.presentedViewController) &#123;</span><br><span class="line">        shouldReceiveTouch = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> shouldReceiveTouch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://github.com/flipboard/flex" target="_blank" rel="external">FLEX</a></li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/06/28/understanding-flex-hit-testing/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/blog/2015/06/28/understanding-sdwebimage-clean/" title="Understanding SDWebImage - Clean" itemprop="url">Understanding SDWebImage - Clean</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Khoa Pham" target="_blank" itemprop="author">Khoa Pham</a>
		
  <p class="article-time">
    <time datetime="2015-06-28T13:20:11.000Z" itemprop="datePublished"> Published 2015-06-28</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="clearDisk"><a href="#clearDisk" class="headerlink" title="clearDisk"></a>clearDisk</h2><p>Erase all files on disk cache. In <code>SDImageCache.m</code><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)clearDiskOnCompletion:(SDWebImageNoParamsBlock)completion</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">dispatch_async</span>(<span class="keyword">self</span>.ioQueue, ^&#123;</span><br><span class="line">        [_fileManager removeItemAtPath:<span class="keyword">self</span>.diskCachePath error:<span class="literal">nil</span>];</span><br><span class="line">        [_fileManager createDirectoryAtPath:<span class="keyword">self</span>.diskCachePath</span><br><span class="line">                withIntermediateDirectories:<span class="literal">YES</span></span><br><span class="line">                                 attributes:<span class="literal">nil</span></span><br><span class="line">                                      error:<span class="literal">NULL</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (completion) &#123;</span><br><span class="line">            <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                completion();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="cleanDisk"><a href="#cleanDisk" class="headerlink" title="cleanDisk"></a>cleanDisk</h2><p>Erase some files based on cache time and cache size<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)cleanDiskWithCompletionBlock:(SDWebImageNoParamsBlock)completionBlock &#123;</span><br><span class="line">   <span class="comment">// ...</span></span><br><span class="line">   <span class="comment">// Erase old files</span></span><br><span class="line">   <span class="built_in">NSDate</span> *expirationDate = [<span class="built_in">NSDate</span> dateWithTimeIntervalSinceNow:-<span class="keyword">self</span>.maxCacheAge];</span><br><span class="line">        <span class="built_in">NSMutableDictionary</span> *cacheFiles = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line">        <span class="built_in">NSUInteger</span> currentCacheSize = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Enumerate all of the files in the cache directory.  This loop has two purposes:</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">//  1. Removing files that are older than the expiration date.</span></span><br><span class="line">        <span class="comment">//  2. Storing file attributes for the size-based cleanup pass.</span></span><br><span class="line">        <span class="built_in">NSMutableArray</span> *urlsToDelete = [[<span class="built_in">NSMutableArray</span> alloc] init];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// Erase more until cache size is preservered</span></span><br><span class="line">    <span class="comment">// If our remaining disk cache exceeds a configured maximum size, perform a second</span></span><br><span class="line">        <span class="comment">// size-based cleanup pass.  We delete the oldest files first.</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.maxCacheSize &gt; <span class="number">0</span> &amp;&amp; currentCacheSize &gt; <span class="keyword">self</span>.maxCacheSize) &#123;</span><br><span class="line">            <span class="comment">// Target half of our maximum cache size for this cleanup pass.</span></span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">NSUInteger</span> desiredCacheSize = <span class="keyword">self</span>.maxCacheSize / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/iOS/">iOS</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/blog/2015/06/28/understanding-sdwebimage-clean/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/4/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/6/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github Card</p>
<div class="github-card" data-github="onmyway133" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/Android/" title="Android">Android<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/Java-Script/" title="Java Script">Java Script<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Life/" title="Life">Life<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Miscellaneous/" title="Miscellaneous">Miscellaneous<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Mobile-Labs/" title="Mobile Labs">Mobile Labs<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/Others/" title="Others">Others<sup>26</sup></a></li>
		  
		
		  
			<li><a href="/categories/Programming/" title="Programming">Programming<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/Others/Windows-8/" title="Windows 8">Windows 8<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Windows-8/" title="Windows 8">Windows 8<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Windows-Phone/" title="Windows Phone">Windows Phone<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/Windows-8/Windows-Phone/" title="Windows Phone">Windows Phone<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/" title="iOS">iOS<sup>85</sup></a></li>
		  
		
		  
			<li><a href="/categories/programming/" title="programming">programming<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/ios/" title="ios">ios<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/wp7/" title="wp7">wp7<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/tutorial/" title="tutorial">tutorial<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/mac-osx/" title="mac osx">mac osx<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/windows-8/" title="windows 8">windows 8<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/android/" title="android">android<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C">C<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/wp8/" title="wp8">wp8<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/convert/" title="convert">convert<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/xcode/" title="xcode">xcode<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/build/" title="build">build<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/visual-studio/" title="visual studio">visual studio<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/programming/" title="programming">programming<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/facebook/" title="facebook">facebook<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/openssl/" title="openssl">openssl<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/voip/" title="voip">voip<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/file/" title="file">file<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/svn/" title="svn">svn<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/disable/" title="disable">disable<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/view-controller/" title="view controller">view controller<sup>3</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> A dream is not a dream anymore when you don&#39;t have time for it <br/>
			What you don&#39;t know is what you haven&#39;t learned</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/onmyway133" target="_blank" class="icon-github" title="github"></a>
		
		
		<a href="http://stackoverflow.com/users/1418457/onmyway133" target="_blank" class="icon-stack-overflow" title="stackoverflow"></a>
		
		
		<a href="https://twitter.com/onmyway133" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		
		
		
		
		
		<a href="mailto:onmyway133@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="Khoa Pham">Khoa Pham</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-40119591-1', 'fantageek.com');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
